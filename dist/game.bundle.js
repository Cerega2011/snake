(()=>{let t,e,n,o=document.querySelector("canvas"),i=o.getContext("2d"),l=document.querySelector(".start"),r=document.querySelector(".score"),c=0,d=0,h=0,a=7,u=0,f=.02*o.width,w=f,s=20,g=40,y=[],v=document.querySelector(".block-1");v.addEventListener("touchmove",(function(t){if(t.preventDefault(),!m||!M)return;let e=t.touches[0],n=e.clientX-m,o=e.clientY-M;Math.abs(n)>Math.abs(o)?n>0?(a=7,u=0):(a=-7,u=0):o>0?(a=0,u=7):(a=0,u=-7),m=null,M=null})),v.addEventListener("touchstart",(function(t){let e=t.touches[0];m=e.clientX,M=e.clientY}));let m=null,M=null;function S(){(d>=o.width-f||d<0||h>=o.height-w||h<0)&&(clearInterval(n),alert("Вы умерли, ваш счёт  "+c),R()),i.clearRect(0,0,o.width,o.height),y.unshift({x:d,y:h}),y.length>g/f&&y.pop();for(let t=0;t<y.length;t++)i.fillRect(y[t].x,y[t].y,f,w);d=(d+a+o.width)%o.width,h=(h+u+o.height)%o.height,i.fillStyle="red",i.fillRect(t,e,s,s),d<t+s&&d+f>t&&h<e+s&&h+w>e&&(L(),g+=50,i.fillRect(y,h,f,w),c++,p())}function L(){let n=o.width-s-20,i=o.height-s-20;e=Math.floor(Math.random()*i)+10,t=Math.floor(Math.random()*n)+10}function R(){c=0,a=7,u=0,d=0,h=0,y=[],g=40,p()}function p(){r.textContent=c%10==1&&c%100!=11?"Вы собрали "+c+" яблоко":c%10>=2&&c%10<=4&&!(c%100>=12&&c%100<=14)?"Вы собрали "+c+" яблока":"Вы собрали "+c+" яблок"}function A(){o.width=window.innerWidth,o.height=window.innerHeight,f=.06*o.width,w=.06*o.width,s=.06*o.width,t=Math.floor(Math.random()*o.width),e=Math.floor(Math.random()*o.height),L()}i.fillStyle="green",i.fillRect(d,h,f,w),window.addEventListener("resize",A),document.addEventListener("keydown",(function(t){t.preventDefault(),"KeyS"==t.code||"ArrowDown"==t.code?(u=7,a=0):"KeyD"==t.code||"ArrowRight"==t.code?(a=7,u=0):"KeyA"==t.code||"ArrowLeft"==t.code?(a=-7,u=0):"KeyW"!=t.code&&"ArrowUp"!=t.code||(u=-7,a=0)})),l.addEventListener("click",(function(){R(),A(),L(),n=setInterval(S,40)}))})();